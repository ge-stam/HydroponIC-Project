\hypertarget{rp2040__pio_8h_source}{}\doxysection{rp2040\+\_\+pio.\+h}
\label{rp2040__pio_8h_source}\index{lib/Adafruit\_NeoPixel/rp2040\_pio.h@{lib/Adafruit\_NeoPixel/rp2040\_pio.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ //}}
\DoxyCodeLine{2 \textcolor{comment}{// This file is autogenerated by pioasm; do not edit! //}}
\DoxyCodeLine{3 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ //}}
\DoxyCodeLine{4 }
\DoxyCodeLine{5 \textcolor{comment}{// Unless you know what you are doing...}}
\DoxyCodeLine{6 \textcolor{comment}{// Lines 47 and 52 have been edited to set transmit bit count}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#if !PICO\_NO\_HARDWARE}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include "{}hardware/pio.h"{}}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/ //}}
\DoxyCodeLine{13 \textcolor{comment}{// ws2812 //}}
\DoxyCodeLine{14 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/ //}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#define ws2812\_wrap\_target 0}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#define ws2812\_wrap 3}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define ws2812\_T1 2}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#define ws2812\_T2 5}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#define ws2812\_T3 3}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{keyword}{static} \textcolor{keyword}{const} uint16\_t ws2812\_program\_instructions[] = \{}
\DoxyCodeLine{24     \textcolor{comment}{//     .wrap\_target}}
\DoxyCodeLine{25     0x6221, \textcolor{comment}{//  0: out    x, 1            side 0 [2]}}
\DoxyCodeLine{26     0x1123, \textcolor{comment}{//  1: jmp    !x, 3           side 1 [1]}}
\DoxyCodeLine{27     0x1400, \textcolor{comment}{//  2: jmp    0               side 1 [4]}}
\DoxyCodeLine{28     0xa442, \textcolor{comment}{//  3: nop                    side 0 [4]}}
\DoxyCodeLine{29             \textcolor{comment}{//     .wrap}}
\DoxyCodeLine{30 \};}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{preprocessor}{\#if !PICO\_NO\_HARDWARE}}
\DoxyCodeLine{33 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keyword}{struct }pio\_program ws2812\_program = \{}
\DoxyCodeLine{34     .instructions = ws2812\_program\_instructions,}
\DoxyCodeLine{35     .length = 4,}
\DoxyCodeLine{36     .origin = -\/1,}
\DoxyCodeLine{37 \};}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 \textcolor{keyword}{static} \textcolor{keyword}{inline} pio\_sm\_config ws2812\_program\_get\_default\_config(uint offset) \{}
\DoxyCodeLine{40   pio\_sm\_config c = pio\_get\_default\_sm\_config();}
\DoxyCodeLine{41   sm\_config\_set\_wrap(\&c, offset + ws2812\_wrap\_target, offset + ws2812\_wrap);}
\DoxyCodeLine{42   sm\_config\_set\_sideset(\&c, 1, \textcolor{keyword}{false}, \textcolor{keyword}{false});}
\DoxyCodeLine{43   \textcolor{keywordflow}{return} c;}
\DoxyCodeLine{44 \}}
\DoxyCodeLine{45 }
\DoxyCodeLine{46 \textcolor{preprocessor}{\#include "{}hardware/clocks.h"{}}}
\DoxyCodeLine{47 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} ws2812\_program\_init(PIO pio, uint sm, uint offset, uint pin,}
\DoxyCodeLine{48                                        \textcolor{keywordtype}{float} freq, uint bits) \{}
\DoxyCodeLine{49   pio\_gpio\_init(pio, pin);}
\DoxyCodeLine{50   pio\_sm\_set\_consecutive\_pindirs(pio, sm, pin, 1, \textcolor{keyword}{true});}
\DoxyCodeLine{51   pio\_sm\_config c = ws2812\_program\_get\_default\_config(offset);}
\DoxyCodeLine{52   sm\_config\_set\_sideset\_pins(\&c, pin);}
\DoxyCodeLine{53   sm\_config\_set\_out\_shift(\&c, \textcolor{keyword}{false}, \textcolor{keyword}{true},}
\DoxyCodeLine{54                           bits); \textcolor{comment}{// <-\/-\/-\/-\/<<< Length changed to "{}bits"{}}}
\DoxyCodeLine{55   sm\_config\_set\_fifo\_join(\&c, PIO\_FIFO\_JOIN\_TX);}
\DoxyCodeLine{56   \textcolor{keywordtype}{int} cycles\_per\_bit = ws2812\_T1 + ws2812\_T2 + ws2812\_T3;}
\DoxyCodeLine{57   \textcolor{keywordtype}{float} div = clock\_get\_hz(clk\_sys) / (freq * cycles\_per\_bit);}
\DoxyCodeLine{58   sm\_config\_set\_clkdiv(\&c, div);}
\DoxyCodeLine{59   pio\_sm\_init(pio, sm, offset, \&c);}
\DoxyCodeLine{60   pio\_sm\_set\_enabled(pio, sm, \textcolor{keyword}{true});}
\DoxyCodeLine{61 \}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
