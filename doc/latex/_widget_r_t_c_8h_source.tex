\hypertarget{_widget_r_t_c_8h_source}{}\doxysection{Widget\+RTC.\+h}
\label{_widget_r_t_c_8h_source}\index{lib/Blynk/src/WidgetRTC.h@{lib/Blynk/src/WidgetRTC.h}}
\mbox{\hyperlink{_widget_r_t_c_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#ifndef WidgetRTC\_h}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#define WidgetRTC\_h}}
\DoxyCodeLine{13 }
\DoxyCodeLine{14 \textcolor{preprocessor}{\#if !defined(ARDUINO)}}
\DoxyCodeLine{15 \textcolor{preprocessor}{    \#error WidgetRTC is not available on this platform!}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{_blynk_widget_base_8h}{Blynk/BlynkWidgetBase.h}}>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <Blynk/BlynkTemplates.h>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <TimeLib.h>}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{class }\mbox{\hyperlink{class_widget_r_t_c}{WidgetRTC}}}
\DoxyCodeLine{23     : \textcolor{keyword}{public} \mbox{\hyperlink{class_blynk_singleton}{BlynkSingleton}}<WidgetRTC>}
\DoxyCodeLine{24 \{}
\DoxyCodeLine{25 \textcolor{keyword}{public}:}
\DoxyCodeLine{26     \mbox{\hyperlink{class_widget_r_t_c}{WidgetRTC}}() \{\}}
\DoxyCodeLine{27     \textcolor{keywordtype}{void} begin();}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{keyword}{private}:}
\DoxyCodeLine{30     \textcolor{keyword}{static} time\_t requestTimeSync();}
\DoxyCodeLine{31 \};}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{comment}{// This is called by Time library when it needs time sync}}
\DoxyCodeLine{34 time\_t WidgetRTC::requestTimeSync()}
\DoxyCodeLine{35 \{}
\DoxyCodeLine{36     \textcolor{comment}{// Request RTC widget update from the server}}
\DoxyCodeLine{37     Blynk.\mbox{\hyperlink{class_blynk_api_aa063b15eeb3de5ba855a223670190e85}{sendInternal}}(\textcolor{stringliteral}{"{}rtc"{}}, \textcolor{stringliteral}{"{}sync"{}});}
\DoxyCodeLine{38     \textcolor{comment}{// Tell the Time library that we'll set it later}}
\DoxyCodeLine{39     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{40 \}}
\DoxyCodeLine{41 }
\DoxyCodeLine{42 \textcolor{keyword}{inline}}
\DoxyCodeLine{43 \textcolor{keywordtype}{void} WidgetRTC::begin()}
\DoxyCodeLine{44 \{}
\DoxyCodeLine{45     setSyncProvider(requestTimeSync);}
\DoxyCodeLine{46 \}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48 BLYNK\_WRITE(InternalPinRTC) \{}
\DoxyCodeLine{49     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} DEFAULT\_TIME = 1357041600; \textcolor{comment}{// Jan 1 2013}}
\DoxyCodeLine{50     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} blynkTime = param.asLong();}
\DoxyCodeLine{51 }
\DoxyCodeLine{52     \textcolor{keywordflow}{if} (blynkTime >= DEFAULT\_TIME) \{    \textcolor{comment}{// Check the integer is a valid time (greater than Jan 1 2013)}}
\DoxyCodeLine{53         setTime(blynkTime);             \textcolor{comment}{// Sync Time library clock to the value received from Blynk}}
\DoxyCodeLine{54         BLYNK\_LOG1(BLYNK\_F(\textcolor{stringliteral}{"{}Time sync: OK"{}}));}
\DoxyCodeLine{55     \}}
\DoxyCodeLine{56 \}}
\DoxyCodeLine{57 }
\DoxyCodeLine{58 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
